<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html" xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich">
<body>
<ui:composition template="/WEB-INF/templates/layout.xhtml">
	<ui:param name="section" value="home" />
	<ui:param name="page" value="profile" />

	<ui:define name="navigation">
		<ui:include src="navigation.xhtml" />
	</ui:define>

	<ui:define name="page-header">
		<h:graphicImage library="images/32x32" name="profile.png" />
		<h2 class="title"><h:outputText value="Ihr Profil" /></h2>
	</ui:define>

	<ui:define name="page-content">
		<p>
			<h:outputText value="Bitte geben Sie etwaige Änderungen möglichst schnell bekannt, da gewisse Funktionen (Passwort vergessen) auf die Richtigkeit dieser Informationen angewiesen sind." />
		</p>
		<fieldset class="defaultStyle">
			<legend> <h:outputText value="Allgemeine Mitarbeiterdaten:" /> </legend>
			<ol>
				<li class="left">
					<h:outputLabel value="Personalnummer"> </h:outputLabel>
					<div class="output">
						<h:outputText value="#{loginBean.user.pnr}" />
					</div>
				</li>
				<li class="left">
					<h:outputLabel value="Nachname"> </h:outputLabel>
					<div class="output">	
						 <h:outputText value="#{loginBean.user.lastName}" />
					</div>
				</li>
				<li class="right">
					<h:outputLabel value="Vorname"> </h:outputLabel>
					<div class="output"> 
						<h:outputText value="#{loginBean.user.firstName}" />
					</div>
				</li>
				<li class="left">
					<h:outputLabel value="Geschlecht" />
					<div class="output">
						<h:outputText value="#{loginBean.user.gender}" />
					</div>
				</li>
				<li class="right">
					<h:outputLabel value="Geburtsdatum" />
					<div class="output">
						<h:outputText value="#{loginBean.user.birthday}">
							<f:convertDateTime pattern="dd.MM.yyyy" locale="#{localeBean.locale}" timeZone="#{localeBean.timeZone}" />
						</h:outputText> 
					</div>
				</li>
				<li class="left">
					<h:outputLabel value="Primäre Dienststelle"> </h:outputLabel>
					<div class="output">
						<h:outputText value="#{loginBean.user.location.name}" />
					</div>
				</li>
				<li class="right">
					<h:outputLabel value="E-Mail"> </h:outputLabel>
					<div class="output largeInput">
						<h:outputText value="#{loginBean.user.address.email}" />
					</div>
				</li>
				<li class="left">
					<h:outputLabel value="Telefon (dienstlich)" /> 
					<div class="output">
						<h:outputText value="#{loginBean.user.address.phone}" />
					</div>
				</li>
				<li class="right">
					<h:outputLabel value="Telefon (privat)" />
					<div class="output">
						<h:outputText value="#{loginBean.user.address.phone2}" />
					</div>
				</li>
			</ol>
		</fieldset>
		<fieldset class="defaultStyle"> <legend> <h:outputText value="Logindaten:" /> </legend>
			<ol>
				<li class="left">
					<h:outputLabel value="Benutzername"> </h:outputLabel>
					<div class="output">
						<h:outputText value="#{loginBean.login.loginName}"  />
					</div>
				</li>
				<li class="right">
					<h:outputLabel value="Passwort"> </h:outputLabel>
					<div class="output">
						<a4j:commandLink value="Passwort ändern" oncomplete="#{rich:component('changePasswortPanel')}.show();return false;" />					
					</div>
				</li>
			</ol>
		</fieldset>
		
		<fieldset class="defaultStyle"> 
			<legend> <h:outputText value="Kompetenzen" /> </legend>
			<p>	<h:outputText value="Die folgenden Ausbildungen von Ihnen sind im System hinterlegt: " /> </p>
			<h:outputText value="Keine Einträge gefunden" styleClass="italic" rendered="#{empty loginBean.user.competences}" />
			<div class="output">
				<a4j:repeat value="#{loginBean.user.competences}" var="competence" rowKeyVar="rowIndex">
					<h:outputText value="#{competence.name}" />
					<h:outputText value=" , " rendered="#{rowIndex lt fn:length(loginBean.user.competences)-1}" />
				</a4j:repeat>
			</div>
		</fieldset>
		
		<fieldset class="defaultStyle"> <legend> <h:outputText value="Benutzergruppen" /> </legend>
			<p>	<h:outputText value="Die Gruppen definieren welche Aktionen Sie ausführen und auf welche Seiten Sie Zugriff haben" /> </p>
			<h:outputText value="Keine Einträge gefunden" styleClass="italic" rendered="#{empty loginBean.user.groups}" />
			<div class="output">
				<a4j:repeat value="#{loginBean.user.groups}" var="group" rowKeyVar="rowIndex">
					<h:outputText value="#{group.name}" />
					<h:outputText value=" , " rendered="#{rowIndex lt fn:length(loginBean.user.groups)-1}" />
				</a4j:repeat>
			</div>
		</fieldset>
	</ui:define>
	
	<ui:define name="page-panels">
		<a4j:jsFunction name="submitPanel" actionListener="#{loginBean.changePassword}" reRender="page-content" />
	
		<ui:decorate template="/WEB-INF/templates/widgets/confirmPanel.xhtml">
			<ui:param name="panelId" value="changePasswortPanel" />
			<ui:param name="panelHeader" value="Kennwort ändern" />
			
			<ui:define name="panelContent">
				<rich:messages errorClass="errorMessage" globalOnly="true" />
				<p>
					<h:outputText value="Bitte geben Sie ihr gewünschtes neues Kennwort ein" />
				</p>
				<fieldset class="defaultStyle">
					<ol>
						<li>
							<h:outputLabel value="Altes Kennwort" styleClass="label" /> 
							<div class="output">
								<h:inputSecret value="#{loginBean.currentPassword}" />
							</div>
						</li>
						<li>
							<h:outputLabel value="Neues Kennwort" styleClass="label" /> 
							<div class="output">
								<h:inputSecret id="password" value="#{loginBean.password}" />
							</div>
						</li>
						<li>
							<h:outputLabel value="Bestätigen" styleClass="label" /> 
							<div class="output">
								<h:inputSecret id="password2" value="#{loginBean.password2}" />
							</div>
						</li>
					</ol>
				</fieldset>
			</ui:define>
		</ui:decorate>
	</ui:define>

</ui:composition>
</body>
</html>